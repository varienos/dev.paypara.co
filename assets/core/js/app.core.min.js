$.varien={boot:()=>new Promise(function(t,e){fetch(window.location.protocol+"//"+window.location.hostname+"/json/resources").then(t=>t.json()).then(e=>t(e))}),init:function(){$.varien.prepare(),$.varien.stage()},errorHandler:function(t,e,a,n,o){var i=new XMLHttpRequest;i.open("POST","https://dev.paypara.co/dev/errorHandler/js",!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onload=(()=>{console.error(t),console.error("$.varien.errorHandler.source: "+e),console.error("$.varien.errorHandler.source.line: "+a),console.error("$.varien.errorHandler.source.col: "+n)}),i.send("location="+window.location+"&source="+e+"&line="+a+"&col="+n+"&error="+o+"&getClientIpAddress="+$.resource.getClientIpAddress+"&getBrowser="+$.resource.getBrowser+"&getAgentString="+$.resource.getAgentString+"&getPlatform="+$.resource.getPlatform+"&getMobile="+$.resource.getMobile+"&getBrowserVersion="+$.resource.getBrowserVersion)},prepare:function(){$.varien.authorization(),$.varien.toastr(),$.varien.activity(),setInterval(function(){$.varien.activity()},$.activityTimeOut)},stage:function(){"dashboard"==$.varien.segment(1)&&$.varien.dashboard.init(),"account"==$.varien.segment(1)&&$.varien.account.init(),"customer"==$.varien.segment(1)&&$.varien.customer.init(),"user"==$.varien.segment(1)&&$.varien.user.init(),"transaction"==$.varien.segment(1)&&$.varien.transaction.init(),"setting"==$.varien.segment(1)&&$.varien.setting.init(),"dev"==$.varien.environment()&&$.varien.dev.init()},authorization:()=>{$('[auth="false"]').each(function(t){$(this).remove()}),setTimeout(function(){$("body").addClass("ready")},500)},eventControl:function(t){t.stopImmediatePropagation(),t.stopPropagation(),t.preventDefault()},environment:()=>($.host=window.location.host,$.host.split(".")[0]),activity:function(){var t=new XMLHttpRequest;t.onreadystatechange=function(){4==this.readyState&&this.status},t.open("GET","user/activity",!0),t.send()},include:function(t,e){return new Promise(function(a,n){if($("["+e+"]")){var o=new XMLHttpRequest;o.open("POST",t,!0),o.onload=function(){200==this.status&&$("[datatable-head]").html(this.responseText).promise().done(function(){a($("#datatable_content thead tr th").length)}),404==this.status&&n({status:this.status,statusText:xhr.statusText})},o.send()}})},segment:function(t){return $.segment=window.location.pathname.split("/"),void 0!==$.segment[t]?$.segment[t]:null},toastr:function(){toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toastr-top-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"3000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"}},modal:{ajax:{element:()=>$("#ajaxModal"),content:()=>$("#ajaxModalContent"),preloader:()=>'<div class="blockui-overlay"><span class="spinner-border text-primary"></span></div>'},event:{load:function(t,e){$.varien.modal.event.show(),$.varien.modal.event.hide(),$(".modal.fade.show").length?$("#ajaxModalContent").html("").promise().done(function(){}):$("#ajaxModal").modal("toggle"),$("#ajaxModalContent").load(t,"",function(){e()})},hide:function(){$("#ajaxModal").on("hidden.bs.modal",function(t){$("#ajaxModalContent").html(""),$(".modal-dialog").length&&$(".modal-dialog").removeClass("mx-wi-p-80")})},show:function(){$("#ajaxModal").on("shown.bs.modal",function(t){})},toggle:function(){$("#ajaxModal").modal("toggle")}}},datatable:{locale:function(){return{emptyTable:"No records",infoEmpty:"No records",infoFiltered:"(filtered from _MAX_ total entries)",loadingRecords:"Loading...",processing:"Loading...",zeroRecords:"No matching records found",info:"Showing _START_ to _END_ of _TOTAL_ entries"}},exportEvents:()=>{if($("#datatableExport").length){var t='<div class="menu-item px-3">';t+='<a href="javascript:;" class="menu-link px-3" export-copy>Copy to Clipboard</a>',t+="</div>",t+='<div class="menu-item px-3">',t+='<a href="javascript:;" class="menu-link px-3" export-xls>Export as Excel</a>',t+="</div>",t+='<div class="menu-item px-3">',t+='<a href="javascript:;" class="menu-link px-3" export-csv>Export as CSV</a>',t+="</div>",t+='<div class="menu-item px-3">',t+='<a href="javascript:;" class="menu-link px-3" export-pdf>Export as PDF</a>',t+="</div>",$("#datatableExport").html(t).promise().done(function(){$("[export-csv]").on("click",function(t){return t.preventDefault(),$(".buttons-csv ").trigger("click"),!1}),$("[export-xls]").on("click",function(t){return t.preventDefault(),$(".buttons-excel ").trigger("click"),!1}),$("[export-copy]").on("click",function(t){return t.preventDefault(),$(".buttons-copy ").trigger("click"),!1}),$("[export-pdf]").on("click",function(t){return t.preventDefault(),$(".buttons-pdf ").trigger("click"),!1}),$("[export-print]").on("click",function(t){return t.preventDefault(),$(".buttons-print ").trigger("click"),!1})})}}},dev:{init:function(){$.getScript(window.location.protocol+"//"+window.location.hostname+"/"+$.resource.gulpAssets+"/plugins/custom/css-element-queries/css.element.queries.bundle.js"),document.addEventListener("keydown",function(t){36==t.keyCode&&$.varien.modal.event.load("dev",function(){$(".modal-dialog").addClass("mx-wi-p-80"),new ResizeSensor(document.getElementById("console"),function(){$("#devConsole").animate({scrollTop:$("#devConsole").prop("scrollHeight")},100)}),document.addEventListener("keydown",function(t){13==t.keyCode&&($("#console").append("<li class='cmdloading'>"+$("#cmd").val()+"</li>"),$.varien.dev.cmd($("#cmd").val()),$("#cmd").val(""))})})})},cmd:function(t){"string.manage"==t?$.varien.modal.event.load("dev/string",function(){}):$.ajax({url:window.location.protocol+"//"+window.location.hostname+"/dev/console",type:"POST",dataType:"html",data:"cmd="+t,success:function(t){$("#console").append(t),$("#console li").removeClass("cmdloading")},error:function(t,e,a){$("#console").append(t.status+"<br>"+e+"<br>"+a)}})}},dashboard:{init:function(){var t=depositFetchWeekly[0].dayTotal+depositFetchWeekly[1].dayTotal+depositFetchWeekly[2].dayTotal+depositFetchWeekly[3].dayTotal+depositFetchWeekly[4].dayTotal+depositFetchWeekly[5].dayTotal+depositFetchWeekly[6].dayTotal;if(t+=withdrawFetchWeekly[0].dayTotal+withdrawFetchWeekly[1].dayTotal+withdrawFetchWeekly[2].dayTotal+withdrawFetchWeekly[3].dayTotal+withdrawFetchWeekly[4].dayTotal+withdrawFetchWeekly[5].dayTotal+withdrawFetchWeekly[6].dayTotal,t>0){let t=document.getElementById("chart-dashboard"),e=parseInt(KTUtil.css(t,"height")),a="#7E8299",n="#a4d19f",o="#e3868c",i={series:[{name:"Deposit",data:[depositFetchWeekly[0].dayTotal,depositFetchWeekly[1].dayTotal,depositFetchWeekly[2].dayTotal,depositFetchWeekly[3].dayTotal,depositFetchWeekly[4].dayTotal,depositFetchWeekly[5].dayTotal,depositFetchWeekly[6].dayTotal]},{name:"Withdraw",data:[withdrawFetchWeekly[0].dayTotal,withdrawFetchWeekly[1].dayTotal,withdrawFetchWeekly[2].dayTotal,withdrawFetchWeekly[3].dayTotal,withdrawFetchWeekly[4].dayTotal,withdrawFetchWeekly[5].dayTotal,withdrawFetchWeekly[6].dayTotal]}],chart:{type:"line",height:e,toolbar:{show:!1},zoom:{enabled:!1}},legend:{show:!0,position:"top",horizontalAlign:"right"},fill:{type:"gradient",gradient:{shadeIntensity:.25,type:"vertical"}},stroke:{width:4,curve:"smooth"},xaxis:{categories:[withdrawFetchWeekly[0].day,withdrawFetchWeekly[1].day,withdrawFetchWeekly[2].day,withdrawFetchWeekly[3].day,withdrawFetchWeekly[4].day,withdrawFetchWeekly[5].day,withdrawFetchWeekly[6].day],tickPlacement:"between",axisBorder:{show:!1},axisTicks:{show:!1},labels:{style:{colors:a,fontSize:"12px",fontWeight:"500"}},tooltip:{enabled:!1}},yaxis:{show:!1},tooltip:{style:{fontSize:"13px"},y:{formatter:function(t){let e=Math.abs(t);return e=e>1e6?(e/1e6).toFixed(2)+"m":e>=1e3&&e<1e6?(e/1e3).toFixed(0)+"k":e>0&&e<1e3?e:"none",e}}},colors:[n,o],grid:{yaxis:{lines:{show:!1}}}},r=new ApexCharts(t,i);r.render()}}},account:{init:()=>{"index"==$.varien.segment(2)&&("1"==$.varien.segment(3)&&($("[data-page-title]").html("Papara Accounts"),$.varien.account.setType(1),$.varien.include("account/include/datatableHeadNormal","datatable-head").then(function(t){$.varien.account.datatable.init(t)})),"2"==$.varien.segment(3)&&($("[data-page-title]").html("Matching Accounts"),$.varien.account.setType(2),$.varien.include("account/include/datatableHeadMatch","datatable-head").then(function(t){$.varien.account.datatable.init(t)})),"3"==$.varien.segment(3)&&($("[data-page-title]").html("Bank Accounts"),$.varien.account.setType(3),$.varien.include("account/include/datatableHeadBank","datatable-head").then(function(t){$.varien.account.datatable.init(t)}))),"detail"==$.varien.segment(2)&&$.varien.account.detail.init()},detail:{init:function(){$.varien.account.detail.datatable.init(),"2"==$.varien.segment(4)&&($.varien.account.detail.refreshMatchTotalBadge(),$.varien.account.detail.datatable.listDisableMatch.init(),$.varien.account.detail.listMatch()),$.varien.account.detail.save(),$('input[data-set="switch"]').on("change",function(){1==$(this).is(":checked")?($.varien.account.detail.switch("on"),$('input[name="status"]').val("on"),toastr.success("Account has been activated")):($.varien.account.detail.switch(0),$('input[name="status"]').val(0),toastr.error("Account has been deactivated"))}),$("#formReset").click(function(){$('input[name="account_name"]').val(""),$('input[name="account_number"]').val(""),$('input[name="limitProcess"]').val(""),$('input[name="limitDeposit"]').val(""),$('select[name="perm_site[]"]').val([]).change()})},refreshMatchTotalBadge:function(){$.varien.account.detail.accountTotalMatch().done(function(t){$("span.badge.badge.badge-circle").html(t.total)})},customerQuery:function(t,e){t.length>3?($("#customerQuery").css("display",""),$.ajax({url:"account/customerQuery",type:"POST",dataType:"html",data:"s="+t+"&account_id="+e,success:function(t){""!=t&&$("#customerQuery ul").html(t)},error:function(t,e,a){$("#customerQuery").html(t.status+"<br>"+e+"<br>"+a)}})):$("#customerQuery").css("display","none")},customerQueryFocusOut:function(){setTimeout(function(){$("#customerQuery").css("display","none"),$("#customerQueryInput").val("")},500)},accountTotalMatch:function(){return $.ajax({url:"account/accountTotalMatch/"+$.varien.segment(3),dataType:"json"})},match:function(t){var e=$('input[name="match_limit"]').val();$.varien.account.detail.accountTotalMatch().done(function(a){var n=a.total;if(n>=e)return toastr.error("Associated client limit cannot be exceeded!"),!1;$.ajax({url:"account/match/"+$.varien.segment(3),type:"POST",dataType:"html",data:"customer_id="+t,success:function(){toastr.success("The customer is paired with the account"),$.varien.account.detail.listMatch(),$.varien.account.detail.datatable.listDisableMatch.reload(),$.varien.account.detail.refreshMatchTotalBadge()}})})},removeMatch:function(t){$.ajax({url:"account/removeMatch/"+t,dataType:"html",success:function(){$.varien.account.detail.listMatch(),$.varien.account.detail.datatable.listDisableMatch.reload(),$.varien.account.detail.refreshMatchTotalBadge()}})},listMatch:function(){$.ajax({dataType:"html",url:"account/listMatch/"+$.varien.segment(3),success:function(t){$("#listMatch").length&&$("#listMatch").html(t)}})},listDisableMatch:function(){$.ajax({dataType:"html",url:"account/listDisableMatch/"+$.varien.segment(3),success:function(t){$("#listDisableMatch").length&&$("#listDisableMatch").html(t)}})},switch:function(t){$.ajax({url:"account/status/"+$.varien.segment(3)+"/"+t,type:"POST",dataType:"html",cache:!1})},datatable:{init:function(){$("button#filtre").css("width","130px"),$("input#transactionDate").css("width","210px"),$.table=new DataTable("#accountTransactions",{bStateSave:!1,language:$.varien.datatable.locale(),dom:'<"#dtExportButtonsWrapper"B>rt<"row"<"col-sm-12 col-md-5 d-flex align-items-center justify-content-center justify-content-md-start"li><"col-sm-12 col-md-7 d-flex align-items-center justify-content-center justify-content-md-end"p>>',buttons:["copy","csv","excel","pdf"],stateSave:!1,lengthMenu:[10,25,50,100],order:[0,"desc"],searching:!0,ordering:!0,processing:!0,serverSide:!0,pageLength:10,ajax:{url:"account/transaction/"+$.varien.segment(3),type:"POST",data:function(t){t.transactionDate=$("#transactionDate").val()}}}),$("#search").on("keyup",function(){$.table.search(this.value).draw()}),$("#transactionDate").on("change",function(){$.table.ajax.reload()}),$.varien.account.detail.datatable.dateSelect(),$.varien.account.detail.datatable.onLoad()},listDisableMatch:{init:function(){$.tableListDisableMatch=new DataTable("#listDisableMatch",{bStateSave:!1,language:$.varien.datatable.locale(),dom:'<"#dtExportButtonsWrapper"B>rt<"row"<"col-sm-12 col-md-5 d-flex align-items-center justify-content-center justify-content-md-start"li><"col-sm-12 col-md-7 d-flex align-items-center justify-content-center justify-content-md-end"p>>',buttons:["copy","csv","excel","pdf"],stateSave:!1,lengthMenu:[10,25,50,100],order:[0,"desc"],searching:!1,ordering:!1,processing:!0,serverSide:!0,pageLength:10,ajax:{url:"account/listDisableMatch/"+$.varien.segment(3)}}),$.varien.account.detail.datatable.listDisableMatch.onLoad()},reload:function(){$.tableListDisableMatch.ajax.reload()},onLoad:function(){$.tableListDisableMatch.on("draw",function(){})}},onLoad:function(){$.table.on("draw",function(){setTimeout(function(){$.varien.datatable.exportEvents()},300)})},dateSelect:function(){function t(t,e){$("#transactionDate").html(t.format("DD.MM.YYYY")+" - "+e.format("DD.MM.YYYY"))}$("#transactionDate").css("text-align","center");let e=moment().startOf("month"),a=moment().endOf("month");$("#transactionDate").daterangepicker({startDate:e,endDate:a,ranges:{Today:[moment(),moment()],Yesterday:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Last 7 Days":[moment().subtract(6,"days"),moment()],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]},locale:{format:"DD/MM/YYYY",separator:" - ",applyLabel:"Apply",cancelLabel:"Cancel",customRangeLabel:"Custom Range",firstDay:1}},t),t(e,a)}},save:function(){$("form#modalForm").on("submit",function(t){$.varien.eventControl(t),$.ajax({url:"account/save",type:"POST",dataType:"html",crossDomain:!0,data:new FormData(this),xhrFields:{withCredentials:!0},processData:!1,contentType:!1,success:function(t){toastr.success("Account updated")},error:function(t,e,a){Swal.fire({text:"XHR ERROR - "+t.status+" "+e+" "+a,icon:"error",buttonsStyling:!1,confirmButtonText:"Close",customClass:{confirmButton:"btn btn-primary"}})}})})}},getType:function(){return $("[data-account-type]").attr("data-account-type")},setType:function(t){$("[data-account-type]").attr("data-account-type",t)},datatable:{init:t=>{"1"==$.varien.segment(3)&&($.notOrderCols=[t-1]),"2"==$.varien.segment(3)&&($.notOrderCols=[t-1]),"3"==$.varien.segment(3)&&($.notOrderCols=[t-1]),1==$.resource.edit_papara_account||1==$.resource.delete_papara_account||"1"!=$.varien.segment(3)&&"2"!=$.varien.segment(3)||($.noVisibleCols=[t-1]),1!=$.resource.edit_bank_account&&1!=$.resource.delete_bank_account&&"3"==$.varien.segment(3)&&($.noVisibleCols=[t-1]),$.table=new DataTable("#datatable_content",{bStateSave:!1,language:$.varien.datatable.locale(),dom:'<"#dtExportButtonsWrapper"B>rt<"row"<"col-sm-12 col-md-5 d-flex align-items-center justify-content-center justify-content-md-start"li><"col-sm-12 col-md-7 d-flex align-items-center justify-content-center justify-content-md-end"p>>',buttons:["copy","csv","excel","pdf"],stateSave:!1,lengthMenu:[10,25,50,100],columnDefs:[{orderable:!1,targets:1==Array.isArray($.notOrderCols)?$.notOrderCols:[]},{targets:1==Array.isArray($.noVisibleCols)?$.noVisibleCols:[],visible:!1}],searching:!0,ordering:!0,processing:!0,serverSide:!0,pageLength:10,ajax:{url:"account/datatable/"+$.varien.segment(3),type:"POST",data:$("#formFilter").serializeArray()}}),$.varien.account.datatable.onLoad(),$("#search").on("keyup",function(){$.table.search(this.value).draw()}),$("#accountStatus").on("change",function(){$.table.search(this.value).draw()}),$('[data-set="status-set-all"]').on("click",function(){var t="on"==$(this).attr("data-status")?"activated":"deactivated",e=$(this).attr("data-status");bootbox.confirm({backdrop:!0,centerVertical:!0,title:"Update Account Status",message:"All accounts will be "+t+". Are you sure?",buttons:{confirm:{label:"Confirm"},cancel:{label:"Cancel"}},callback:a=>{1==a&&($.varien.account.datatable.status(0,e),toastr.success("All accounts "+t+"."),setTimeout(()=>{$.table.ajax.reload()},500))}})})},onLoad:function(){$.table.on("draw",function(){setTimeout(function(){$.varien.datatable.exportEvents(),"1"==$.varien.segment(3)&&$("tbody td:nth-child(7)").addClass("text-end"),"2"==$.varien.segment(3)&&$("tbody td:nth-child(8)").addClass("text-end"),"3"==$.varien.segment(3)&&$("tbody td:nth-child(8)").addClass("text-end"),$('input[data-set="index"]').on("change",function(){1==$(this).is(":checked")?($.varien.account.datatable.status($(this).attr("data-id"),"on"),toastr.success("Account has been activated")):($.varien.account.datatable.status($(this).attr("data-id"),0),toastr.error("Account has been deactivated"))}),$.varien.account.datatable.modal(),$.varien.account.datatable.remove()},300)})},status:function(t,e){$.ajax({url:"account/status/"+t+"/"+e+"/"+$.varien.segment(3),type:"POST",dataType:"html",cache:!1})},modal:function(){$('[id="formAjax"]').on("click",function(){$.varien.modal.event.load($(this).attr("data-url"),function(){$.varien.account.datatable.submit(),$('#ajaxModalContent select[name="perm_site[]"]').select2(),$('#ajaxModalContent select[name="bank_id"]').select2()})})},submit:function(){$("form#modalForm").on("submit",function(t){$.varien.eventControl(t),$.ajax({url:"account/save",type:"POST",dataType:"html",crossDomain:!0,data:new FormData(this),xhrFields:{withCredentials:!0},processData:!1,contentType:!1,success:function(t){$.table.ajax.reload(),$("#ajaxModal").modal("toggle")},error:function(t,e,a){Swal.fire({text:"XHR ERROR - "+t.status+" "+e+" "+a,icon:"error",buttonsStyling:!1,confirmButtonText:"Close",customClass:{confirmButton:"btn btn-primary"}})}})})},remove:function(){$('[data-set="delete"]').on("click",function(){var t=$(this).attr("delete-url");$(this).attr("delete-msg");bootbox.confirm({backdrop:!0,centerVertical:!0,title:"Delete Account",message:"Do you approve to delete this account? This process is irreversible!",buttons:{confirm:{label:"Confirm"},cancel:{label:"Cancel"}},callback:e=>{1==e&&$.ajax({type:"POST",url:t,success:function(){$.table.ajax.reload(),toastr.error("Account has been deleted")}})}})})}}},transaction:{init:function(){$("button#filtre").css("width","180px"),$("input#transactionDate").css("width","210px"),$(".modal-dialog").addClass("w-325px"),$.varien.transaction.dateSelect(),$.bsFirstTab=bootstrap.Tab.getInstance(document.querySelector("#myTab li:first-child a")),$.drawer=KTDrawer.getInstance(document.querySelector("#drawer")),$.drawer.on("kt.drawer.show",function(){1==$("#sync").is(":checked")&&$("#sync").trigger("click")}),$.drawer.on("kt.drawer.hide",function(){$.bsFirstTab.show(),$.varien.transaction.datatable.reload(),$.varien.transaction.datatable.isToday()&&0==$("#sync").is(":checked")&&$("#sync").trigger("click")}),$.blockDatatable=new KTBlockUI(document.querySelector("#datatable_content")),$.blockModalContent=new KTBlockUI(document.querySelector("#ajaxModalContent")),KTCookie.set("recordsTotal",0);let t=!1;$(document).on("click",()=>{if(!t){t=!0,console.log('document.createElement("audio")');let e=document.createElement("audio");e.setAttribute("src",$.resource.coreAssets+"/audio/notification.mp3"),e.setAttribute("muted","muted"),e.setAttribute("id","notification"),document.body.appendChild(e)}}),"deposit"==$.varien.segment(3)&&($("[data-page-title]").html("Deposits"),$.varien.include("transaction/include/datatableHeadDeposit","datatable-head").then(function(t){$.varien.transaction.datatable.init(t)})),"withdraw"==$.varien.segment(3)&&($("[data-page-title]").html("Withdrawals"),$.varien.include("transaction/include/datatableHeadWithdraw","datatable-head").then(function(t){$.varien.transaction.datatable.init(t)})),$.varien.transaction.datatable.getNotifications().done(function(t){1==t.status&&0==$("#notifications").is(":checked")&&$("#notifications").trigger("click"),0==t.status&&1==$("#notifications").is(":checked")&&$("#notifications").trigger("click")}),$.varien.transaction.datatable.rejectAll()},dateSelect:function(){function t(t,e){$("#transactionDate").html(t.format("DD.MM.YYYY")+" - "+e.format("DD.MM.YYYY"))}$("#transactionDate").css("text-align","center");let e=moment(),a=moment();$("#transactionDate").daterangepicker({startDate:e,endDate:a,ranges:{Today:[moment(),moment()],Yesterday:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Last 7 Days":[moment().subtract(6,"days"),moment()],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]},locale:{format:"DD/MM/YYYY",separator:" - ",applyLabel:"Apply",cancelLabel:"Cancel",customRangeLabel:"Custom Range",firstDay:1}},t),t(e,a)},datatable:{init:function(t){"deposit"==$.varien.segment(3)&&($.notOrderCols=[1,2,3,t-2,t-1]),"withdraw"==$.varien.segment(3)&&($.notOrderCols=[1,2,3,4,5,6,8,9]),1!=$.resource.edit_transaction_deposit&&"deposit"==$.varien.segment(3)&&($.noVisibleCols=[t-1]),1!=$.resource.edit_transaction_withdraw&&"withdraw"==$.varien.segment(3)&&($.noVisibleCols=[t-1]),$.table=new DataTable("#datatable_content",{language:$.varien.datatable.locale(),dom:'<"#dtExportButtonsWrapper"B>rt<"row"<"col-sm-12 col-md-5 d-flex align-items-center justify-content-center justify-content-md-start"li><"col-sm-12 col-md-7 d-flex align-items-center justify-content-center justify-content-md-end"p>>',buttons:["copy","csv","excel","pdf"],bStateSave:!1,stateSave:!1,lengthMenu:[10,25,50,100],order:[0,"desc"],columnDefs:[{orderable:!1,targets:1==Array.isArray($.notOrderCols)?$.notOrderCols:[]},{targets:1==Array.isArray($.noVisibleCols)?$.noVisibleCols:[],visible:!1}],searching:!0,ordering:!0,processing:!0,serverSide:!0,pageLength:10,ajax:{url:"transaction/datatable/"+$.varien.segment(3),type:"POST",data:function(t){t.transactionDate=$("#transactionDate").val(),t.siteId=$("#siteId").val(),t.method=$("#method").val(),t.status=$("#status").val(),t.accountId=$("#accountIdFilter").val()}}}),$.varien.transaction.datatable.onLoad(),$.varien.transaction.datatable.sync(),$.varien.transaction.datatable.notification(),$("#search").on("keyup",function(){$.table.search(this.value).draw()}),$("#transactionDate").on("change",function(){var t=$("#transactionDate").val(),e=t.split(" - "),a=e[0].split("/"),n=e[1].split("/"),o=new Date(a[2]+"-"+a[1]+"-"+a[0]),i=new Date(n[2]+"-"+n[1]+"-"+n[0]),r=new Date;o.setHours(0,0,0,0),i.setHours(0,0,0,0),r.setHours(0,0,0,0),o.toDateString()===r.toDateString()&&i.toDateString()===r.toDateString()&&0==$("#sync").is(":checked")&&($("#sync").trigger("click"),$.varien.transaction.datatable.reload()),o.toDateString()===r.toDateString()&&i.toDateString()===r.toDateString()||(1==$("#sync").is(":checked")&&$("#sync").trigger("click"),$.varien.transaction.datatable.reload())}),$("#refresh").on("click",function(t){$.varien.eventControl(t),$.varien.transaction.datatable.reload(),toastr.success("Transactions refreshed")}),$("[app-onchange-datatable-reload]").on("change input",function(t){$.varien.eventControl(t),$.varien.transaction.datatable.reload()}),$("[app-onclick-datatable-reset]").on("click",function(t){$.varien.eventControl(t),$("#siteId").val("").trigger("change"),$("#method").val("").trigger("change"),$("#status").val("").trigger("change"),$("#accountIdFilter").val(""),$.varien.transaction.datatable.reload()})},isToday:function(){var t=$("#transactionDate").val(),e=t.split(" - "),a=e[0].split("/"),n=e[1].split("/"),o=new Date(a[2]+"-"+a[1]+"-"+a[0]),i=new Date(n[2]+"-"+n[1]+"-"+n[0]),r=new Date;return o.setHours(0,0,0,0),i.setHours(0,0,0,0),r.setHours(0,0,0,0),o.toDateString()===r.toDateString()&&i.toDateString()===r.toDateString()},sound:()=>{document.getElementById("notification").muted=!1,document.getElementById("notification").loop=!1,document.getElementById("notification").play()},setNotifications:function(t){$.ajax({url:"transaction/notificationSound/"+t,type:"GET",dataType:"html",cache:!1})},getNotifications:function(){return $.ajax({url:"transaction/getNotificationSoundStatus",dataType:"json"})},autoDate:function(){$.varien.transaction.dateSelect()},sync:function(){autoRefreshInterval=setInterval($.varien.transaction.datatable.reload,$.syncTime),autoDateInterval=setInterval($.varien.transaction.datatable.autoDate,$.syncTime),$("#sync").on("click",function(){1==$(this).is(":checked")?("object"==typeof autoRefreshInterval&&(autoRefreshInterval=setInterval($.varien.transaction.datatable.reload,$.syncTime)),"object"==typeof autoDateInterval&&(autoDateInterval=setInterval($.varien.transaction.datatable.autoDate,$.syncTime)),toastr.success("Auto refresh activated")):(clearInterval(autoRefreshInterval),clearInterval(autoDateInterval),autoRefreshInterval=null,autoDateInterval=null,toastr.error("Auto refresh disabled"))})},rejectAll:()=>{$.reject=function(t,e){return new Promise(function(a,n){var o=new XMLHttpRequest;o.open("POST",t,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onload=function(){200==this.status&&a(200),404==this.status&&n({status:this.status,statusText:xhr.statusText})},o.send("request="+$.varien.segment(3)+"&status=reddedildi&response=reject&id="+e)})},$("#reject-all-button").on("click",function(t){$.varien.eventControl(t),$.rowCount=0,$.rowArray=[],$("tbody > tr").length&&$("tbody > tr").each(function(t,e){void 0!==$(e).attr("id")&&$(e).attr("id").indexOf("-1")>0&&($.rowCount+=1,$.rowArray.push({id:$(e).attr("id").split("-")[0],transId:$(e).attr("id").split("-")[2]}))}),0==$.rowCount?toastr.error("No pending transactions"):bootbox.confirm({backdrop:!0,centerVertical:!0,title:"Reject Pending Transactions",buttons:{confirm:{label:"Confirm"},cancel:{label:"Cancel"}},message:$.rowCount+" pending transactions will be rejected. Do you approve?",callback:t=>{1==t&&$.each($.rowArray,function(t,e){$.reject("transaction/update",e.id).then(function(t){toastr.success("#"+e.transId+": transaction rejected"),$.varien.transaction.datatable.reload()})})}})})},notification:function(){$("#notifications").on("click",function(){1==$(this).is(":checked")?(toastr.success("Notifications enabled"),$.varien.transaction.datatable.setNotifications(1),$.varien.transaction.datatable.sound()):(toastr.error("Notifications disabled"),$.varien.transaction.datatable.setNotifications(0))});var t=$.table.page.info();KTCookie.get("recordsTotal")<t.recordsTotal&&1==$("#notifications").is(":checked")&&$.varien.transaction.datatable.sound(),KTCookie.set("recordsTotal",t.recordsTotal)},onLoad:function(){$.table.on("draw",function(){setTimeout(function(){$.varien.datatable.exportEvents(),$('input[data-set="index"]').on("change",function(){1==$(this).is(":checked")?$.varien.transaction.datatable.status($(this).attr("data-id"),"on"):$.varien.transaction.datatable.status($(this).attr("data-id"),0)}),$.varien.transaction.datatable.modal(),$.varien.transaction.datatable.inspect()},500)})},reload:function(){$.table.ajax.reload()},status:function(t,e){$.ajax({url:"transaction/status/"+t+"/"+e+"/"+$.varien.segment(3),type:"POST",dataType:"html",cache:!1})},inspect:function(){$('[id="inspect"]').on("click",function(t){t.preventDefault(t),$.rowId=$(this).attr("data-row-id"),$.userName=$(this).attr("data-user-name"),$.userNote=$(this).attr("data-customer-note"),$.processNote=$(this).attr("data-process-note"),$.accountName=$(this).attr("data-account-name"),$.accountLink=$(this).attr("data-account-link"),$.customerLink=$(this).attr("data-customer-link"),$.customerId=$(this).attr("data-customer-id"),$.customerDeposit=$(this).attr("data-customer-deposit"),$.customerWithdraw=$(this).attr("data-customer-withdraw"),$.isVip=$(this).attr("data-customer-vip"),$.switch=$('input[data-set="switch"]'),$('input[data-set="switch"]').attr("data-id",$.customerId),"on"==$.customerDeposit&&0==$("#deposit").is(":checked")&&$("#deposit").prop("checked",!0),"on"!=$.customerDeposit&&1==$("#deposit").is(":checked")&&$("#deposit").prop("checked",!1),"on"==$.customerWithdraw&&0==$("#withdraw").is(":checked")&&$("#withdraw").prop("checked",!0),"on"!=$.customerWithdraw&&1==$("#withdraw").is(":checked")&&$("#withdraw").prop("checked",!1),$.switch.on("change",function(t){$.varien.eventControl(t),1==$(this).is(":checked")?($.varien.customer.datatable.switch($(this).attr("name"),$(this).attr("data-id"),"on"),"deposit"==$(this).attr("name")?toastr.success("Customer has been allowed to deposit"):"withdraw"==$(this).attr("name")?toastr.success("Customer has been allowed to withdraw"):"isVip"==$(this).attr("name")&&toastr.success("Customer has been made VIP")):($.varien.customer.datatable.switch($(this).attr("name"),$(this).attr("data-id"),0),"deposit"==$(this).attr("name")?toastr.error("Customer's deposit permission has been removed"):"withdraw"==$(this).attr("name")?toastr.error("Customer's withdraw permission has been removed"):"isVip"==$(this).attr("name")&&toastr.error("Customer is no longer VIP"))}),"on"==$.isVip&&0==$("#isVip").is(":checked")&&$("#isVip").prop("checked",!0),"on"!=$.isVip&&1==$("#isVip").is(":checked")&&$("#isVip").prop("checked",!1),$.resource.edit_customer||($("#deposit").prop("disabled",!0),$("#withdraw").prop("disabled",!0),$("#isVip").prop("disabled",!0)),$("[data-set-accountLink]").on("click",function(t){$.varien.eventControl(t),window.open($.accountLink,"_blank")}),$("[data-set-customerLink]").on("click",function(t){$.varien.eventControl(t),window.open($.customerLink,"_blank")}),$.requestTime=$("#"+$.rowId).find("td").eq(0).html(),$.txid=$("#"+$.rowId).find("td").eq(1).html(),$.customerSiteId=$("#"+$.rowId).find("td").eq(2).html(),$.accountId=$("#"+$.rowId).find("td").eq(3).html(),$.client=$("#"+$.rowId).find("td").eq(4).html(),$.method=$("#"+$.rowId).find("td").eq(5).html(),$.customer=$("#"+$.rowId).find("td").eq(6).html(),$.amount=$("#"+$.rowId).find("td").eq(7).html(),$.status=$("#"+$.rowId).find("td").eq(8).html(),$.time=$("#"+$.rowId).find("td").eq(9).html(),$("[data-set-date]").html($.requestTime),$("[data-set-time]").html($.time),$("[data-set-txid]").html($.txid),$("[data-set-accountName]").html($.accountName),$("[data-set-accountId]").html($.accountId),$("[data-set-client]").html($.client),$("[data-set-method]").html($.method).find("div").contents().unwrap(),$("[data-set-customer]").html($.customer),$("[data-set-status]").html($.status).find("div").contents().unwrap(),"Pending"==$.trim($("[data-set-status]").html())&&($("[data-set-status]").addClass("text-gray-800 badge-light-warning"),$("[data-set-status]").removeClass("badge-light-success"),$("[data-set-status]").removeClass("badge-light-danger")),"Approved"==$.trim($("[data-set-status]").html())&&($("[data-set-status]").addClass("badge-light-success"),$("[data-set-status]").removeClass("text-gray-800 badge-light-warning"),$("[data-set-status]").removeClass("badge-light-danger")),"Rejected"==$.trim($("[data-set-status]").html())&&($("[data-set-status]").addClass("badge-light-danger"),$("[data-set-status]").removeClass("text-gray-800 badge-light-warning"),$("[data-set-status]").removeClass("badge-light-success")),""==$.userName?$("#person").hide():($("[data-set-person]").html($.userName),$("#person").show()),""==$.processNote?$("#processNote").hide():($("[data-set-processNote]").html($.processNote),$("#processNote").show()),$("[data-set-customerNote]").html($.userNote),$("[data-set-amount]").html($.amount),$("[data-set-customerId]").html($.customerSiteId)})},
modal:function(){$('[data-bs-target="#ajaxModal"]').on("click",function(){$.varien.modal.event.load($(this).attr("data-url"),function(){$.varien.transaction.datatable.submit()})})},process:function(t){return new Promise(function(e,a){$.ajax(t).done(e).fail(a)})},submit:function(){$("form#modalForm").on("submit",function(t){$.varien.eventControl(t),$.blockDatatable.block(),$.blockModalContent.block(),$.formData=new FormData(this),$.varien.transaction.datatable.process({url:"transaction/update",type:"POST",dataType:"html",crossDomain:!0,data:$.formData,xhrFields:{withCredentials:!0},processData:!1,contentType:!1}).then(function(t){$.table.ajax.reload(),$("#ajaxModal").modal("toggle"),$.blockDatatable.release(),$.blockModalContent.release()},function(t,e,a){Swal.fire({text:t.status+" "+e+" "+a,icon:"error",buttonsStyling:!1,confirmButtonText:"Close",customClass:{confirmButton:"btn btn-primary"}}),$.blockDatatable.release(),$.blockModalContent.release()}).catch(function(t){Swal.fire({text:t.message,icon:"error",buttonsStyling:!1,confirmButtonText:"Close",customClass:{confirmButton:"btn btn-primary"}}),$.blockDatatable.release(),$.blockModalContent.release()})})},remove:function(){$('[data-set="delete"]').on("click",function(){var t=$(this).attr("delete-url"),e=$(this).attr("delete-msg");bootbox.confirm({buttons:{confirm:{label:"Confirm"},cancel:{label:"Cancel"}},message:e,callback:e=>{1==e&&$.ajax({type:"POST",url:t,success:function(){$.table.ajax.reload(),toastr.error("Account deleted")}})}})})}}},user:{init:function(){$("[data-page-title]").html("Users"),"index"==$.varien.segment(2)&&$.varien.include("user/include/datatableHead","datatable-head").then(function(t){$.varien.user.datatable.init(t)}),"detail"==$.varien.segment(2)&&$.varien.user.detail.init(),"roles"==$.varien.segment(2)&&$.varien.user.role.init()},role:{init:function(){$.varien.user.role.datatable.init()},accountType:function(){$("select").on("change",function(){1==$(this).val()&&($('input[name="partner"]').val(1),$('input[name="root"]').val(0)),2==$(this).val()&&($('input[name="partner"]').val(0),$('input[name="root"]').val(1))})},datatable:{init:function(){var t=$("thead tr th").length;1!=$.resource.edit_role&&1!=$.resource.delete_role&&($.noVisibleCols=[t-1]),$.table=new DataTable("#datatableRole",{language:$.varien.datatable.locale(),dom:'<"#dtExportButtonsWrapper"B>rt<"row"<"col-sm-12 col-md-5 d-flex align-items-center justify-content-center justify-content-md-start"li><"col-sm-12 col-md-7 d-flex align-items-center justify-content-center justify-content-md-end"p>>',buttons:["copy","csv","excel","pdf"],bStateSave:!1,stateSave:!1,lengthMenu:[10,25,50,100],order:[0,"desc"],columnDefs:[{orderable:!1,targets:[1,2]},{targets:1==Array.isArray($.noVisibleCols)?$.noVisibleCols:[],visible:!1}],searching:!1,ordering:!1,processing:!0,serverSide:!0,pageLength:10,ajax:{url:"user/datatableRole"}}),$.varien.user.role.datatable.onLoad()},onLoad:function(){$.table.on("draw",function(){setTimeout(function(){$.varien.datatable.exportEvents(),$("tbody td:nth-child(3)").addClass("text-end"),$.varien.user.role.datatable.modal(),$.varien.user.role.datatable.remove()},300)})},modal:function(){$('[id="formAjax"]').on("click",function(){$.varien.modal.event.load($(this).attr("data-url"),function(){$.varien.user.role.datatable.submit(),$.varien.user.role.accountType(),$("select").select2()})})},submit:function(){$("form#roleForm").on("submit",function(t){$.varien.eventControl(t),$.ajax({url:"user/saveRole",type:"POST",dataType:"html",crossDomain:!0,data:new FormData(this),xhrFields:{withCredentials:!0},processData:!1,contentType:!1,success:function(){$.table.ajax.reload(),$("#ajaxModal").modal("toggle"),toastr.success("Roles updated")},error:function(t,e,a){Swal.fire({text:"XHR ERROR - "+t.status+" "+e+" "+a,icon:"error",buttonsStyling:!1,confirmButtonText:"Close",customClass:{confirmButton:"btn btn-primary"}})}})})},remove:function(){$('[data-set="remove"]').on("click",function(){var t=$(this).attr("data-id");bootbox.confirm({backdrop:!0,centerVertical:!0,title:"Delete Role",buttons:{confirm:{label:"Confirm"},cancel:{label:"Cancel"}},message:"Do you approve to delete user role?",callback:e=>{1==e&&$.ajax({type:"POST",url:"user/removeRole/"+t,success:function(){$.table.ajax.reload(),toastr.error("Role deleted")}})}})})},reload:function(){$.table.ajax.reload()}}},detail:{init:function(){$.varien.user.detail.remove(),$.varien.user.detail.update(),$.varien.user.detail.twoFA.init(),$.varien.user.detail.selectedFirms(),$.varien.user.detail.isRoot(),$.varien.user.detail.sessiontable.init()},isRoot:function(){$.resource.root&&$("[current-password-wrapper]").hide()},twoFA:{init:function(){$('[id="formAjax"]').on("click",function(){$.varien.modal.event.load($(this).attr("data-url"),function(){$.wait(500).then(function(){$.varien.user.detail.twoFA.button.qr(),$.varien.user.detail.twoFA.button.manual(),$.varien.user.detail.twoFA.button.next(),$.varien.user.detail.twoFA.button.back(),$.varien.user.detail.twoFA.button.authorization()})})}),$.varien.user.detail.twoFA.button.disable()},authorization:function(){return new Promise(function(t,e){if($("[verificationCode]")){var a=new XMLHttpRequest;a.open("POST",window.location.protocol+"//"+window.location.hostname+"/secure/2fa/verify/"+$("[verificationCode]").val(),!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.onload=function(){200==this.status?t(this.status):e(this.status)},a.send("secret="+$("form#2fa").attr("data-secret"))}})},set2fa:function(){return new Promise(function(t,e){if($("[verificationCode]")){var a=new XMLHttpRequest;a.open("POST",window.location.protocol+"//"+window.location.hostname+"/secure/2fa/setup",!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.onload=function(){200==this.status?t(this.status):e(this.status)},a.send("secret="+$("form#2fa").attr("data-secret"))}})},disable2fa:function(){return new Promise(function(t,e){var a=new XMLHttpRequest;a.open("POST",window.location.protocol+"//"+window.location.hostname+"/secure/2fa/disable",!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.onload=function(){200==this.status?t(this.status):e(this.status)},a.send("user_id="+$.varien.segment(3))})},button:{qr:()=>{$("[data-action-button-qr]").on("click",function(){$("[data-set-2fa-qr]").addClass("d-none"),$("[data-set-2fa-manual]").removeClass("d-none")})},manual:()=>{$("[data-action-button-manual]").on("click",function(){$("[data-set-2fa-manual]").addClass("d-none"),$("[data-set-2fa-qr]").removeClass("d-none")})},next:()=>{$("[data-action-button-next]").on("click",function(){$("[data-set-2fa-qr]").addClass("d-none"),$("[data-set-2fa-manual]").addClass("d-none"),$("[data-action-button-next]").addClass("d-none"),$("[data-set-2fa-verify]").removeClass("d-none")})},back:()=>{$("[data-action-button-back]").on("click",function(){$("[data-set-2fa-qr]").removeClass("d-none"),$("[data-action-button-next]").removeClass("d-none"),$("[data-set-2fa-manual]").addClass("d-none"),$("[data-set-2fa-verify]").addClass("d-none"),$("[verificationCode]").val("")})},authorization:()=>{$("[data-action-button-verify]").on("click",t=>{""!=$("[verificationCode]").val()&&$("[verificationCode]").val().length>=6?$.varien.user.detail.twoFA.authorization().then(t=>{200==t&&$.varien.user.detail.twoFA.set2fa().then(t=>{console.log(t),200==t&&($.varien.modal.event.toggle(),Swal.fire({text:"2-Step verification has been successfully activated",icon:"success",buttonsStyling:!1,confirmButtonText:"Close",customClass:{confirmButton:"btn btn-primary"}}),$.wait(3e3).then(()=>{location.reload()}))}).catch(t=>{toastr.error("Couldn't verify the code. Please try again.")})}).catch(t=>{toastr.error("Couldn't verify the code. Please try again.")}):toastr.error("Please enter your verification code")})},disable:()=>{$("[data-disable-2fa]").length&&$("[data-disable-2fa]").on("click",function(t){bootbox.confirm({backdrop:!0,centerVertical:!0,buttons:{confirm:{label:"Remove"},cancel:{label:"Cancel"}},title:"Remove 2-Step Verification",message:"Are you sure you want to remove 2-step verification?",callback:t=>{1==t&&$.varien.user.detail.twoFA.disable2fa().then(t=>{200==t&&(toastr.success("2-step verification has been successfully removed"),$.wait(1e3).then(function(){location.reload()}))}).catch(t=>{toastr.error("Couldn't remove 2FA. Please try again.")})}})})}}},selectedFirms:()=>{$("#firms").html(""),""!=$("#perm_site").val()?$("#perm_site option:selected").each(function(){$("#firms").append("<li>"+$(this).text()+"</li>")}):$("#firms").append("<li>All Firms</li>")},remove:function(){$('[data-set="remove"]').on("click",function(){var t=$(this).attr("data-id");bootbox.confirm({backdrop:!0,centerVertical:!0,buttons:{confirm:{label:"Confirm"},cancel:{label:"Cancel"}},title:"Delete User",message:"Do you approve to delete the user?",callback:e=>{1==e&&$.ajax({type:"POST",url:"user/remove/"+t,success:function(){toastr.error("User deleted"),window.location.href="user/index"}})}})})},password:function(){var t=$("a[data-pass]").attr("data-pass"),e=$("#current_password").val(),a=$("#user_pass").val(),n=$("#confirm_password").val();return""==e&&1!==$.resource.root?(toastr.error("Please enter your current password"),$("#current_password").focus(),!1):""==a?(toastr.error("Please enter your new password"),$("#user_pass").focus(),!1):""==n?(toastr.error("Please confirm your new password"),$("#confirm_password").focus(),!1):e!=t&&1!==$.resource.root?(toastr.error("You've entered your current password incorrectly"),$("#current_password").focus(),!1):a!=n?(toastr.error("You've entered your new password incorrectly"),$("#confirm_password").focus(),!1):!(a.length<8)||(toastr.error("Your new password must have at least 8 characters"),$("#user_pass").focus(),!1)},update:function(){$('[data-set="update"]').on("click",function(t){$.varien.eventControl(t);var e=$(this).attr("data-id"),a=$(this).attr("data-modal"),n=$(this).attr("data-name"),o=$("#"+n).val();if("user_pass"==n&&!$.varien.user.detail.password())return!1;"email"==n?$.varien.user.check("email",$("[app-submit-email-check]").val(),$("[app-submit-email-check]").attr("current-email")).then(t=>{if(t>0)return toastr.error($("[app-submit-email-check]").val()+" is already exists"),$("[app-submit-email-check]").addClass("inputError"),$("[app-submit-email-check]").focus(),!1;$.ajax({type:"POST",url:"user/update/"+e,data:"dataName="+n+"&dataValue="+o,success:function(){$("[name="+n+"]").html(o),toastr.success("User updated"),$("#"+a).modal("toggle")}})}):$.ajax({type:"POST",url:"user/update/"+e,data:"dataName="+n+"&dataValue="+o,success:function(){"perm_site"==n?$.varien.user.detail.selectedFirms():$("[name="+n+"]").html(o),toastr.success("User updated"),$("#"+a).modal("toggle"),"role_id"==n&&location.reload()}})})},sessiontable:{init:function(){$.table=new DataTable("#sessionTable",{language:$.varien.datatable.locale(),dom:'<"#dtExportButtonsWrapper"B>rt<"row"<"col-sm-12 col-md-5 d-flex align-items-center justify-content-center justify-content-md-start"li><"col-sm-12 col-md-7 d-flex align-items-center justify-content-center justify-content-md-end"p>>',buttons:["copy","csv","excel","pdf"],bStateSave:!1,stateSave:!1,lengthMenu:[5,10,25,50],order:[0,"desc"],columnDefs:[{orderable:!1,targets:[1,2,3]}],searching:!1,ordering:!0,processing:!0,serverSide:!0,pageLength:5,ajax:{url:"user/sessiontable/"+$.varien.segment(3)}}),$.varien.user.detail.sessiontable.onLoad()},onLoad:function(){$.table.on("draw",function(){$.varien.datatable.exportEvents(),$("#sessionTable_info").css("display","none")})},reload:function(){$.table.ajax.reload()}}},check:function(t,e,a=""){return new Promise(function(n,o){var i=new XMLHttpRequest;i.open("POST","user/check",!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onload=function(){200==this.status&&n(parseInt(this.responseText)),200!=this.status&&o({status:this.status,statusText:this.statusText})},i.send("param="+t+"&value="+e+"&current="+a)})},datatable:{init:function(t){1!=$.resource.edit_user&&1!=$.resource.delete_user&&($.noVisibleCols=[t-1]),1==$.resource.edit_user||1==$.resource.delete_user?$.notOrderCols=[t-1]:$.notOrderCols=[],$.table=new DataTable("#datatable_content",{language:$.varien.datatable.locale(),dom:'<"#dtExportButtonsWrapper"B>rt<"row"<"col-sm-12 col-md-5 d-flex align-items-center justify-content-center justify-content-md-start"li><"col-sm-12 col-md-7 d-flex align-items-center justify-content-center justify-content-md-end"p>>',buttons:["copy","csv","excel","pdf"],bStateSave:!1,stateSave:!1,lengthMenu:[10,25,50,100],order:[0,"desc"],columnDefs:[{orderable:!1,targets:$.notOrderCols},{targets:1==Array.isArray($.noVisibleCols)?$.noVisibleCols:[],visible:!1}],searching:!0,ordering:!0,processing:!0,serverSide:!0,pageLength:10,ajax:{url:"user/datatable",type:"POST",data:function(t){t.is2fa=$("#is2fa").val(),t.role_id=$("#role_id").val()}}}),$.varien.user.datatable.onLoad(),$("#search").on("keyup",function(){$.table.search(this.value).draw()}),$("#accountStatus").on("change",function(){$.table.search(this.value).draw()})},onLoad:function(){$.table.on("draw",function(){setTimeout(function(){$.varien.datatable.exportEvents(),$("tbody td:nth-child(1)").addClass("d-flex align-items-center"),$("tbody td:nth-child(6)").addClass("text-end"),$.varien.user.datatable.modal(),$.varien.user.datatable.remove()},300)})},modal:function(){$('[id="formAjax"]').on("click",function(){$.varien.modal.event.load($(this).attr("data-url"),function(){$("select").select2(),$.varien.user.datatable.submit()})})},submit:function(){$("[app-submit-email-check]").focusout(function(){$.varien.user.check("email",$("[app-submit-email-check]").val()).then(t=>{if(t>0)return toastr.error($("[app-submit-email-check]").val()+" already exists"),$("[app-submit-email-check]").addClass("inputError"),$("[app-submit-email-check]").focus(),$(':input[type="submit"]').prop("disabled",!0),!1;toastr.success($("[app-submit-email-check]").val()+" is available"),$("[app-submit-email-check]").removeClass("inputError"),$(':input[type="submit"]').prop("disabled",!1)})}),$("form#modalForm").on("submit",function(t){$.varien.eventControl(t),$.varien.user.check("email",$("[app-submit-email-check]").val()).then(t=>{if(t>0)return toastr.error($("[app-submit-email-check]").val()+" already exists"),$("[app-submit-email-check]").addClass("inputError"),$("[app-submit-email-check]").focus(),$(':input[type="submit"]').prop("disabled",!0),!1;$.ajax({url:"user/save",type:"POST",dataType:"html",crossDomain:!0,data:new FormData(document.getElementById("modalForm")),xhrFields:{withCredentials:!0},processData:!1,contentType:!1,success:function(){$.table.ajax.reload(),$("#ajaxModal").modal("toggle"),toastr.success("User created")},error:function(t,e,a){Swal.fire({text:"XHR ERROR - "+t.status+" "+e+" "+a,icon:"error",buttonsStyling:!1,confirmButtonText:"Close",customClass:{confirmButton:"btn btn-primary"}})}})})})},remove:function(){$('[data-set="remove"]').on("click",function(){var t=$(this).attr("data-id");bootbox.confirm({backdrop:!0,centerVertical:!0,title:"Delete User",buttons:{confirm:{label:"Confirm"},cancel:{label:"Cancel"}},message:"Do you confirm to delete the user?",callback:e=>{1==e&&$.ajax({type:"POST",url:"user/remove/"+t,success:function(){$.table.ajax.reload(),toastr.error("User deleted")}})}})})},reload:function(){$.table.ajax.reload()},reset:function(){$("select#is2fa").val(""),$("select#role").val(""),$.table.ajax.reload()}}},customer:{init:function(){$("[data-page-title]").html("Clients"),"index"==$.varien.segment(2)&&($.varien.include("customer/include/datatableHead","datatable-head").then(function(t){$.varien.customer.datatable.init(t)}),$.varien.customer.selectClient()),"detail"==$.varien.segment(2)&&$.varien.customer.detail.init()},selectClient:function(){$.ajax({url:"client/json",dataType:"json",success:function(t){$.each(t,function(e){$("#selectClient").append('<option value="'+t[e].id+'">'+t[e].name+"</option>")})},error:function(t,e,a){Swal.fire({text:"XHR ERROR - "+t.status+"*"+e+"*"+a,icon:"error",buttonsStyling:!1,confirmButtonText:"Close",customClass:{confirmButton:"btn btn-primary"}})}})},datatable:{init:function(t){$.table=new DataTable("#datatable_content",{language:$.varien.datatable.locale(),dom:'<"#dtExportButtonsWrapper"B>rt<"row"<"col-sm-12 col-md-5 d-flex align-items-center justify-content-center justify-content-md-start"li><"col-sm-12 col-md-7 d-flex align-items-center justify-content-center justify-content-md-end"p>>',buttons:["copy","csv","excel","pdf"],bStateSave:!1,stateSave:!1,lengthMenu:[10,25,50,100],order:[0,"desc"],columnDefs:[{orderable:!1,targets:[t-1]}],searching:!0,ordering:!0,processing:!0,serverSide:!0,pageLength:10,ajax:{url:"customer/datatable",type:"POST",data:function(t){t.selectClient=$("#selectClient").val(),t.isVip=$("#isVip").val()}}}),$.varien.customer.datatable.onLoad(),$("#search").on("keyup",function(){$.table.search(this.value).draw()}),$("#datatableReload").on("click",function(){$.varien.customer.datatable.reload()}),$("#datatableReset").on("click",t=>{$.varien.eventControl(t),$("#selectClient").val("").trigger("change"),$("#isVip").val("").trigger("change"),$.varien.customer.datatable.reset()})},onLoad:function(){$.table.on("draw",function(){setTimeout(function(){$.varien.datatable.exportEvents(),$("tbody td:nth-child(8)").addClass("text-end"),$('input[data-set="switch"]').on("change",function(){1==$(this).is(":checked")?($.varien.customer.datatable.switch($(this).attr("name"),$(this).attr("data-id"),"on"),toastr.success("Customer has been made VIP")):($.varien.customer.datatable.switch($(this).attr("name"),$(this).attr("data-id"),0),toastr.error("Customer is no longer VIP"))})},300)})},switch:function(t,e,a){$.ajax({url:"customer/switch/"+e+"/"+t+"/"+a,type:"POST",dataType:"html",cache:!1})},reload:function(){$.table.ajax.reload()},reset:function(){$("#selectClient").val(""),$("#isVip").val(""),$("#deposit").val(""),$("#withdraw").val(""),$.table.ajax.reload()},submit:function(){$("form#modalForm").on("submit",function(t){$.varien.eventControl(t),$.ajax({url:"customer/save",type:"POST",dataType:"html",crossDomain:!0,data:new FormData(this),xhrFields:{withCredentials:!0},processData:!1,contentType:!1,success:function(t){$.table.ajax.reload(),$("#ajaxModal").modal("toggle")},error:function(t,e,a){Swal.fire({text:"XHR ERROR - "+t.status+" "+e+" "+a,icon:"error",buttonsStyling:!1,confirmButtonText:"Close",customClass:{confirmButton:"btn btn-primary"}})}})})}},detail:{init:function(){$.varien.customer.detail.saveNote(),$.varien.customer.detail.datatable.init(),$.varien.customer.detail.datatable.dateSelect(),$(".modal-dialog").addClass("w-425px"),$('input[data-set="switch"]').on("change",function(){1==$(this).is(":checked")?($.varien.customer.datatable.switch($(this).attr("name"),$(this).attr("data-id"),"on"),"deposit"==$(this).attr("name")?toastr.success("Customer has been allowed to deposit"):"withdraw"==$(this).attr("name")?toastr.success("Customer has been allowed to withdraw"):"isVip"==$(this).attr("name")&&toastr.success("Customer has been made VIP")):($.varien.customer.datatable.switch($(this).attr("name"),$(this).attr("data-id"),0),"deposit"==$(this).attr("name")?toastr.error("Customer's deposit permission has been removed"):"withdraw"==$(this).attr("name")?toastr.error("Customer's withdraw permission has been removed"):"isVip"==$(this).attr("name")&&toastr.error("Customer is no longer VIP"))})},saveNote:function(){$("button#customerNoteSave").on("click",function(){$.ajax({url:"customer/save/note/"+$.varien.segment(3),dataType:"html",type:"POST",data:"customerNote="+$("#customerNote").val(),success:function(){toastr.success("Customer note updated")},error:function(t,e,a){Swal.fire({text:"XHR ERROR - "+t.status+"*"+e+"*"+a,icon:"error",buttonsStyling:!1,confirmButtonText:"Close",customClass:{confirmButton:"btn btn-primary"}})}})})},datatable:{init:function(){$.table=new DataTable("#customerTransactionTable",{language:$.varien.datatable.locale(),dom:'<"#dtExportButtonsWrapper"B>rt<"row"<"col-sm-12 col-md-5 d-flex align-items-center justify-content-center justify-content-md-start"li><"col-sm-12 col-md-7 d-flex align-items-center justify-content-center justify-content-md-end"p>>',buttons:["copy","csv","excel","pdf"],bStateSave:!1,stateSave:!1,lengthMenu:[10,25,50,100],order:[0,"desc"],columnDefs:[{orderable:!1,targets:[1,6]}],searching:!0,ordering:!0,processing:!0,serverSide:!0,pageLength:10,ajax:{url:"transaction/customerTransactionTable/"+$.varien.segment(4)+"/"+$.varien.segment(5),type:"POST",data:function(t){t.transactionDate=$("#transactionDate").val(),t.method=$("#method").val(),t.status=$("#status").val(),t.accountId=$("#accountIdFilter").val()}}}),$.varien.customer.detail.datatable.onLoad(),$("#search").on("keyup",function(){$.table.search(this.value).draw()}),$("#transactionDate").on("change",function(){$.varien.customer.detail.datatable.reload()}),$("[app-onclick-datatable-reload]").on("click",function(t){$.varien.eventControl(t),$.varien.customer.detail.datatable.reload()}),$("[app-onclick-datatable-reset]").on("click",function(t){$.varien.eventControl(t),$("#method").val("").trigger("change"),$("#status").val("").trigger("change"),$("#accountIdFilter").val(""),$.varien.customer.detail.datatable.reload()})},reload:function(){$.table.ajax.reload()},onLoad:function(t){$.table.on("draw",function(){$.varien.datatable.exportEvents(),$("tbody td:nth-child(7)").addClass("text-end"),setTimeout(function(){$.varien.customer.detail.datatable.modal()},500)})},dateSelect:function(){function t(t,e){$("#transactionDate").html(t.format("DD.MM.YYYY")+" - "+e.format("DD.MM.YYYY"))}$("#transactionDate").css("text-align","center");let e=moment().startOf("month"),a=moment().endOf("month");$("#transactionDate").daterangepicker({startDate:e,endDate:a,ranges:{Today:[moment(),moment()],Yesterday:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Last 7 Days":[moment().subtract(6,"days"),moment()],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]},locale:{format:"DD/MM/YYYY",separator:" - ",applyLabel:"Apply",cancelLabel:"Cancel",customRangeLabel:"Custom Range",firstDay:1}},t),t(e,a)},modal:function(){$('[data-bs-target="#ajaxModal"]').on("click",function(){$.varien.modal.event.load($(this).attr("data-url"),function(){})})}}}},reports:{init:function(){$.varien.reports.charts.main.init(),$.varien.reports.charts.pie.init()},charts:function(){}},setting:{init:function(){$('[id="updateSetting"]').on("click",function(t){$('[name="maintenanceStatus"]').closest("form").attr("id");var e=$(this).attr("data-form-id");$.varien.setting.submit(e),$("form#"+e).submit()}),$('input[data-set="statusSwitch"]').on("change",function(){var t=$(this),e=$('input[name="'+$(this).attr("name")+'"]').closest("form").attr("id");"maintenanceStatus"!=$(this).attr("name")?($.varien.setting.switch($(this)),$.varien.setting.submitStatus(e,$(this).attr("name")),$("form#"+e).submit()):1==$(this).is(":checked")?bootbox.confirm({backdrop:!0,centerVertical:!0,title:"Warning!",message:"Are you sure you want to activate maintenance mode?",buttons:{confirm:{label:"Confirm"},cancel:{label:"Cancel"}},callback:a=>{1==a?(KTCookie.set("cancel",0),$.varien.setting.switch(t),$.varien.setting.submitStatus(e,t.attr("name")),$("form#"+e).submit()):(KTCookie.set("cancel",1),t.trigger("click"))}}):(1!=KTCookie.get("cancel")&&($.varien.setting.switch(t),$.varien.setting.submitStatus(e,t.attr("name")),$("form#"+e).submit()),KTCookie.set("cancel",0))}),$('button[id="resetSetting"]').on("click",function(){var t=$(this).closest("form").attr("id");$("form#"+t+" input").each(function(t){$(this).val($(this).attr("data-default"))}),$("form#"+t+" select").each(function(t){$(this).val("").trigger("change")})}),$.varien.setting.client.init()},switch:function(t){1==t.is(":checked")?t.val("on"):t.val("0")},submit:function(t){$("form#"+t).on("submit",function(t){$.varien.eventControl(t);var e=new FormData(this);$.ajax({url:"setting/update",type:"POST",dataType:"html",crossDomain:!0,data:e,xhrFields:{withCredentials:!0},processData:!1,contentType:!1,success:function(){toastr.success("Settings updated")},error:function(t,e,a){Swal.fire({text:"XHR ERROR - "+t.status+" "+e+" "+a,icon:"error",buttonsStyling:!1,confirmButtonText:"Close",customClass:{confirmButton:"btn btn-primary"}})}})})},submitStatus:function(t,e){$("form#"+t).on("submit",function(t){$.varien.eventControl(t),$.ajax({url:"setting/update",type:"POST",dataType:"html",crossDomain:!0,data:e+"="+$('[name="'+e+'"]').val(),success:function(){toastr.success("Settings updated"),"maintenanceStatus"==e&&location.reload()},error:function(t,e,a){Swal.fire({text:"XHR ERROR - "+t.status+" "+e+" "+a,icon:"error",buttonsStyling:!1,confirmButtonText:"Close",customClass:{confirmButton:"btn btn-primary"}})}})})},client:{init:function(){1!=$.resource.edit_firm&&1!=$.resource.delete_firm&&($.noVisibleCols=[$("thead tr th").length-1]),$.table=new DataTable("#datatableClient",{language:$.varien.datatable.locale(),dom:'<"#dtExportButtonsWrapper"B>rt<"row"<"col-sm-12 col-md-5 d-flex align-items-center justify-content-center justify-content-md-start"li><"col-sm-12 col-md-7 d-flex align-items-center justify-content-center justify-content-md-end"p>>',buttons:["copy","csv","excel","pdf"],bStateSave:!1,stateSave:!1,lengthMenu:[10,25,50,100],order:[0,"desc"],columnDefs:[{orderable:!1,targets:1==Array.isArray($.notOrderCols)?[2,3]:[2,3,5]},{targets:1==Array.isArray($.noVisibleCols)?$.noVisibleCols:[],visible:!1}],searching:!0,ordering:!0,processing:!0,serverSide:!0,pageLength:10,ajax:{url:"client/datatable",type:"POST",data:function(t){}}}),$.varien.setting.client.onLoad(),$("#search").on("keyup",function(){$.table.search(this.value).draw()}),$("#datatableReload").on("click",function(){$.varien.setting.client.reload()}),$("#datatableReset").on("click",function(){$.varien.setting.client.reset()})},onLoad:function(){$.table.on("draw",function(){setTimeout(function(){$.varien.datatable.exportEvents(),$.varien.setting.client.modal(),$.varien.setting.client.remove(),$("tbody td:nth-child(6)").addClass("text-end"),$('input[data-set="switch"]').on("change",function(){1==$(this).is(":checked")?($.varien.setting.client.switch($(this).attr("name"),$(this).attr("data-id"),"on"),toastr.success("The firm has been authorized to perform transactions")):($.varien.setting.client.switch($(this).attr("name"),$(this).attr("data-id"),0),toastr.error("Firm's authorization has been revoked"))})},300)})},modal:function(){$('[data-bs-target="#clientModalForm"]').on("click",function(){var t=$(this).attr("data-id");"0"!=t?($("[data-title]").html("Edit Firm"),$("#generateKey").html("Generate"),$.varien.setting.client.detail(t)):($('[name="id"]').val(0),$('[name="site_name"]').val(""),$('[name="api_key"]').val(""),$('[id="modalStatus"]').val("").change(),$("[data-title]").html("Add New Firm"),$("#generateKey").html("Generate")),$('[data-bs-dismiss="modal"]').on("click",function(){setTimeout(function(){$('[name="id"]').val(""),$('[name="site_name"]').val(""),$('[name="api_key"]').val(""),$('[id="modalStatus"]').val("").change()},300)}),$.varien.setting.client.save(t),$("#generateKey").on("click",function(){$('[name="api_key"]').val($.varien.setting.client.generateKey())})})},detail:function(t){$.ajax({url:"client/detail/"+t,dataType:"json",success:function(t){$('[name="id"]').val(t.id),$('[name="site_name"]').val(t.site_name),$('[name="api_key"]').val(t.api_key_pin+"-****-****-****-************"),$('[id="modalStatus"]').val(t.status).change()}})},switch:function(t,e,a){$.ajax({url:"client/switch/"+e+"/"+t+"/"+a,type:"POST",dataType:"html",cache:!1})},reload:function(){$.table.ajax.reload()},reset:function(){$.table.ajax.reload()},generateKey:function(){var t=(new Date).getTime();window.performance&&"function"==typeof window.performance.now&&(t+=performance.now());var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var a=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?a:3&a|8).toString(16)});return e},save:function(){$("button#saveClient").on("click",function(t){$.varien.eventControl(t);var e=$('[name="id"]').val(),a=$('[name="site_name"]').val(),n=$('[name="api_key"]').val(),o=$('[id="modalStatus"]').find(":selected").val();return""==a?(toastr.error("Please enter firm's name"),!1):""==n?(toastr.error("Please enter API Key"),!1):($.ajax({url:"client/save",type:"POST",dataType:"html",crossDomain:!0,data:"id="+e+"&site_name="+a+"&api_key="+n+"&status="+o,xhrFields:{withCredentials:!0},success:function(){return $.table.ajax.reload(),$("#clientModalForm").modal("toggle"),toastr.success("Firm's data has been updated"),!1},error:function(t,e,a){Swal.fire({text:"XHR ERROR - "+t.status+" "+e+" "+a,icon:"error",buttonsStyling:!1,confirmButtonText:"Close",customClass:{confirmButton:"btn btn-primary"}})}}),!1)})},remove:function(){$('[data-set="remove"]').on("click",function(){var t=$(this).attr("data-id");bootbox.confirm({backdrop:!0,centerVertical:!0,title:"Delete Firm",message:"Are you sure to delete the firm?",buttons:{confirm:{label:"Confirm"},cancel:{label:"Cancel"}},callback:e=>{1==e&&$.ajax({type:"POST",url:"client/remove/"+t,success:function(){$.table.ajax.reload(),toastr.error("The firm has been deleted")}})}})})}}}},$.varien.boot().then(t=>{$.resource=t,$.syncTime=1e4,$.activityTimeOut=3e4,$.ajaxSetup({cache:!1}),$.wait=(t=>($.defer=$.Deferred(),setTimeout(()=>{$.defer.resolve()},t),$.defer)),window.addEventListener("error",t=>{$.varien.errorHandler(t,t.error.fileName,t.error.lineNumber,t.error.columnNumber,t.error.message)})}).then(()=>{$.varien.init()}).catch(t=>{$.varien.errorHandler(t,t.fileName,t.lineNumber,t.columnNumber,t.message)});